üì¶ DOCUMENTO 1 ‚Äî CLAUDE AI (n8n)
PROYECTO: MY HOST BizMate
M√ìDULO: AUTOPILOT
ROL DE ESTE DOCUMENTO: CONTEXTO MAESTRO DE ARQUITECTURA Y FLUJOS
ALCANCE: BACKEND / AUTOMATION ONLY (n8n)
REGLA CR√çTICA: IMPLEMENTAR POR FASES ¬∑ FLUJOS LINEALES ¬∑ SIN SOBREINGENIER√çA

========================================================
1) CONTEXTO GENERAL
========================================================
MY HOST BizMate es una plataforma para villa owners no t√©cnicos
(WhatsApp / Instagram first, gesti√≥n manual, alta presi√≥n operativa).

El m√≥dulo AUTOPILOT automatiza el trabajo real del owner:
- responder mensajes
- controlar pagos
- gestionar reservas
- dar claridad diaria / semanal / mensual

Autopilot NO es un agente conversacional.
Autopilot es una **capa de workflows autom√°ticos**.

========================================================
2) ARQUITECTURA GENERAL
========================================================

Frontend (ClaudeCode / App)
‚Üí llama webhooks n8n
‚Üí lee resultados desde Supabase

n8n (TU RESPONSABILIDAD)
‚Üí ejecuta flujos autom√°ticos
‚Üí orquesta mensajes, pagos, res√∫menes
‚Üí escribe estados y summaries en Supabase

Supabase
‚Üí base de datos √∫nica
‚Üí estados, logs, summaries
‚Üí punto de integraci√≥n app ‚Üî n8n

========================================================
3) ESTRUCTURA DE AUTOPILOT
========================================================
Autopilot se divide en 3 niveles l√≥gicos:

- DAILY    ‚Üí operaci√≥n y urgencia
- WEEKLY   ‚Üí control, prevenci√≥n, planificaci√≥n
- MONTHLY  ‚Üí claridad financiera

IMPORTANTE:
La implementaci√≥n es POR FASES.
Ahora mismo SOLO se ejecuta FASE 1 (DAILY).

========================================================
4) MAPA GLOBAL DE WORKFLOWS
========================================================

FASE 1 ‚Äî AUTOPILOT DAILY (IMPLEMENTAR AHORA)
- WF-D1 ‚Äî Always-On Inquiries
- WF-D2 ‚Äî Payment Protection
- WF-D3 ‚Äî Daily Owner Summary
- WF-D4 ‚Äî Review / Issue Watch (opcional)

FASE 2 ‚Äî AUTOPILOT WEEKLY (DESPU√âS)
- WF-W1 ‚Äî Weekly Business Check
- WF-W2 ‚Äî Weekly Ops Checklist

FASE 3 ‚Äî AUTOPILOT MONTHLY (DESPU√âS)
- WF-M1 ‚Äî Monthly Close & Report

Workflow transversal:
- WF-A1 ‚Äî Approval Executor (ejecuta acciones aprobadas desde la app)

========================================================
5) PRINCIPIOS DE DISE√ëO (NO NEGOCIABLES)
========================================================
- 1 workflow = 1 responsabilidad
- Flujos lineales (7‚Äì10 nodos m√°x.)
- Multi-tenant siempre (tenant_id, property_id)
- Todo estado debe guardarse en Supabase
- Nada de l√≥gica de UI
- Evitar ‚ÄúAI tools‚Äù complejas con doble llamada
- Usar IA solo cuando aporte valor real (copy, resumen)

========================================================
6) DATA CONTRACT GENERAL
========================================================
Todos los workflows trabajan con estos conceptos:

ENTRADAS:
- Webhooks (WhatsApp, IG, App)
- Eventos internos (booking_created, payment_received)
- Cron jobs (daily / weekly / monthly)

ESTADOS CLAVE:
- Lead: new / contacted / closed
- Booking: hold / pending_payment / confirmed / expired / cancelled
- Payment: pending / received / failed
- Autopilot item: done / needs_approval / alert

SALIDAS:
- Records en Supabase:
  - daily_summary
  - weekly_summary
  - monthly_summary
  - autopilot_actions
  - logs / alerts

========================================================
7) FASE 1 ‚Äî AUTOPILOT DAILY (RESUMEN)
========================================================
Autopilot Daily cubre el trabajo diario REAL del owner.

Incluye:
- Responder mensajes 24/7
- Capturar leads
- Controlar pagos y expiraciones
- Generar resumen diario simple

Estos workflows:
- se disparan por eventos o cron
- NO requieren intervenci√≥n humana
- alimentan directamente la pantalla Autopilot / Daily

El detalle nodo a nodo de cada workflow
se entregar√° en documentos siguientes.

========================================================
8) REGLA DE IMPLEMENTACI√ìN
========================================================
Implementar FASE 1 completa.
Validar.
Solo despu√©s avanzar a Weekly y Monthly.

NO anticipar.
NO mezclar fases.
NO a√±adir features no descritas.

========================================================
FIN DEL DOCUMENTO
ESTE ES EL CONTEXTO MAESTRO PARA CLAUDE AI (n8n)
========================================================