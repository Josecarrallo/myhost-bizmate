DOCUMENTO OFICIAL — CLAUDE AI (N8N WORKFLOWS)
MÓDULO: CONTENT GENERATOR
PROYECTO: MY HOST – BizMate
ESTADO: DEFINITIVO / LISTO PARA IMPLEMENTAR
ALCANCE: BACKEND / AUTOMATION ONLY (n8n)
REGLA CRÍTICA: SIMPLICIDAD. FLUJO LINEAL. SIN SOBREINGENIERÍA.

================================================================
0. ACLARACIÓN IMPORTANTE (LECTURA OBLIGATORIA)
================================================================
Cuando este documento habla de “NODOS”, se refiere a:
BLOQUES DE UN WORKFLOW EN N8N.

Un NODO = un paso del flujo.
Un WORKFLOW = nodos conectados en orden.

Ejemplo mental:
Webhook → Validar → IA → Guardar → Responder

NO diseñar UI.
NO añadir lógica innecesaria.
NO dividir en múltiples workflows en esta fase.

================================================================
1. QUÉ ES EL CONTENT GENERATOR
================================================================
El Content Generator es un módulo de generación automática de contenido
para marketing en hospitality (hoteles, villas, retreats).

NO es solo copywriting.
ES un generador estructurado que:
- entiende contexto operativo y comercial
- genera contenido por canal
- devuelve resultados estructurados (JSON)
- guarda borradores
- puede ser disparado por humanos o por otros agentes AI

Vive en: MARKETING & GROWTH
Se integra con: OSIRIS / LUMINA / BANYU

================================================================
2. QUÉ TIENE QUE HACER (COMPORTAMIENTO)
================================================================
Para cada solicitud, el sistema debe:

1. Recibir una petición de contenido
2. Validar y normalizar inputs
3. Generar contenido con IA (Claude)
4. Devolver el contenido estructurado
5. Guardar el resultado como DRAFT
6. (Opcional) Enviar preview por WhatsApp / Email

NO publicar automáticamente.

================================================================
3. INPUTS DEL WORKFLOW (DATA CONTRACT)
================================================================
El Webhook de entrada recibe este JSON mínimo:

{
  "property_id": "string",
  "property_name": "string",
  "channel": "instagram | tiktok | website | email | whatsapp | ads",
  "content_type": "post | reel | story | carousel | email | landing",
  "objective": "bookings | awareness | last_minute | upsell",
  "tone": "luxury | warm | playful | professional | minimal",
  "language": "en | es | id",
  "cta": "Book now | Contact us | Discover more",
  "context": {
    "occupancy": "low | medium | high",
    "season": "low | high | peak",
    "event": "string | null"
  }
}

Si falta algún campo:
- usar valores por defecto
- NO fallar el workflow

================================================================
4. OUTPUT OBLIGATORIO (STRUCTURED)
================================================================
Claude DEBE devolver siempre JSON estructurado.
NO texto libre.

{
  "title": "string",
  "hook": "string",
  "body_copy": "string",
  "cta": "string",
  "hashtags_or_keywords": ["string"],
  "visual_guidelines": ["string"],
  "recommended_variants": {
    "instagram": "string",
    "email": "string",
    "website": "string"
  }
}

Si el output no es válido:
- retry 1 vez
- si falla → fallback + log

================================================================
5. WORKFLOW N8N — NODOS EXACTOS
================================================================
El workflow debe implementarse como una cadena LINEAL de nodos:

NODO 1 — Webhook
- Tipo: Webhook Trigger
- Método: POST
- Recibe el JSON de entrada

NODO 2 — Validate & Defaults
- Tipo: Set / IF
- Validar campos obligatorios
- Aplicar defaults si faltan datos

NODO 3 — Claude AI
- Tipo: AI / HTTP (según integración)
- Rol: Hospitality Marketing Expert
- Instrucción:
  “Generate marketing content for hospitality.
   Return ONLY valid JSON following the schema provided.”

NODO 4 — Parse & Validate Output
- Tipo: IF / Function
- Verificar que el JSON contiene todos los campos
- Si no → retry o fallback

NODO 5 — Save Draft
- Tipo: Supabase / Google Sheets / DB
- Guardar:
  - input
  - output
  - status = "draft"
  - timestamp

NODO 6 — Optional Notification
- Tipo: WhatsApp (BANYU) o Email
- Enviar preview si se solicita

NODO 7 — Respond to Webhook
- Tipo: Respond to Webhook
- Devolver el JSON generado al frontend

================================================================
6. INTEGRACIÓN CON AGENTIC AI
================================================================
Este workflow puede ser disparado por:

- Usuario humano (Marketing)
- OSIRIS (baja ocupación)
- LUMINA (oportunidad de venta)
- Market Intelligence (evento / demanda)

Ejemplo:
OSIRIS detecta baja ocupación → trigger Content Generator
LUMINA detecta lead caliente → trigger Content Generator

================================================================
7. REGLAS IMPORTANTES
================================================================
- SIEMPRE generar DRAFT primero
- NO publicar automáticamente
- Lenguaje hospitality premium
- NO inventar precios ni promociones
- CTA alineado con objetivo
- Contenido reutilizable multicanal

================================================================
8. OBJETIVO FINAL
================================================================
Reducir trabajo manual de marketing.
Activar contenido basado en contexto real.
Permitir escalado sin añadir equipo.

================================================================
FIN DEL DOCUMENTO — EJECUTAR SIN INTERPRETAR
================================================================